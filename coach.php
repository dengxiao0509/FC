
<style type="text/css">
#coach {
}
.coachpopup {
	display: none;
	overflow: auto;
	border: 1px solid grey;
	background: lightgrey;
	z-index: 100;
	position: absolute;
	left: 80px;
	top: 170px;
	height: 550px;
	width: 1000px;
	font-family: Verdana,Arial,Sans-serif;
	font-size: 14px;
	padding: 10px;
	-moz-border-radius:10px;
	-webkit-border-radius:10px;
	border-radius:10px;
	-moz-box-shadow:3px 3px 6px 0 #A9A9A9;
	-webkit-box-shadow:3px 3px 6px #A9A9A9;
	box-shadow:3px 3px 6px 0 #A9A9A9;
}
#headcoach {
	height: 80px;
}
#titlecoach {
	width: 400px;
	margin-left: 150px;
	float: left;
	text-align: center;
}
#showinfocoachaccount {
	display: none;
	margin-left: 150px;
	float: left;
	margin-top: 10px;
	text-align: right;
}
#showinfocoachaccount img {
	margin: 0px;
}
#newcasecoach {
	margin-left: 15px;
	float: left;
	margin-top: 10px;
	text-align: right;
}
#newcasecoach img {
	margin: 0px;
}
#newCase {
	font-size: 14px;
	display: none;
	border:1px solid #C0C0C0;
	background: white;
	color: black;
	padding: 10px;
	margin: 10px;
	font-family: Verdana,Arial,Sans-serif;
	text-align: center;
	/*css3*/
	-moz-border-radius:10px;
	-webkit-border-radius:10px;
	border-radius:10px;
	-moz-box-shadow:3px 3px 6px 0 #A9A9A9;
	-webkit-box-shadow:3px 3px 6px #A9A9A9;
	box-shadow:3px 3px 6px 0 #A9A9A9;
}
#newEvent {
	font-size: 14px;
	display: none;
	background: white;
	border:1px solid #C0C0C0;
	color: black;
	padding: 10px;
	margin: 10px;
	font-family: Verdana,Arial,Sans-serif;
	text-align: center;
	/*css3*/
	-moz-border-radius:10px;
	-webkit-border-radius:10px;
	border-radius:10px;
	-moz-box-shadow:3px 3px 6px 0 #A9A9A9;
	-webkit-box-shadow:3px 3px 6px #A9A9A9;
	box-shadow:3px 3px 6px 0 #A9A9A9;
}

.coachcase {
	border:1px solid #C0C0C0;
	color: black;
	padding: 10px;
	margin: 10px;
	font-family: Verdana,Arial,Sans-serif;
	text-align: center;
	background: wheat;
	/*css3*/
	-moz-border-radius:10px;
	-webkit-border-radius:10px;
	border-radius:10px;
	-moz-box-shadow:3px 3px 6px 0 #A9A9A9;
	-webkit-box-shadow:3px 3px 6px #A9A9A9;
	box-shadow:3px 3px 6px 0 #A9A9A9;
}
.ccclos {
	background: grey;
	color: white;
}
.ccgauche {
	float: left;
	width: 150px;
}
.cccentre {
	float: left;
	max-width: 650px;
	text-align: left;
}
.ccdroite {
	float: right;
	max-width: 200px;
	text-align: right;
	postion: relative;
}
.ccdate {
	position: relative;
	text-align: left;
	font-size: 12px;
	margin-right: 50px;
}
.clear {
	clear: both;
}
.ccaccount {
	position: relative;
	font-size: 20px;
}

.ccaccount:hover {
	margin-left : 3px;
}

.ccstatus {
	position: relative;
	text-align: left;
	font-size: 16px;
	border: 1px grey;
	padding: 5px;
}
.ccstatusrejete {
	background: black;
}
.cccoach {
	position: relative;
	text-align: left;
	font-size: 12px;
}
.cccoachvide {
	background: red;
	color: white;
	position: relative;
	text-align: left;
	font-size: 12px;
	padding: 1px 0px 1px 5px;
}
.cctype {
	position: relative;
	font-style: italic;
	font-size: 14px;
}
.cctypenom {
	float: left;
	position: relative;
	font-style: italic;
	font-size: 15px;
}

.cctypedevisamount {
	border:1px solid #C0C0C0;
	float: left;
	position: relative;
	background: green;
	color: white;
	padding: 2px;
	top: -2px;
	margin: 0px 40px;
	font-size: 14px;
	text-align: center;
	width: 90px;
}
.cctypepacknom {
	float: left;
	margin: 0 15px;
	position: relative;
	font-style: italic;
	font-size: 15px;
}
.cctypepackamount {
	border:1px solid #C0C0C0;
	float: left;
	position: relative;
	background: green;
	color: white;
	padding: 2px;
	top: -2px;
	margin: 0 5px;
	font-size: 14px;
	text-align: center;
	width: 90px;
}
.cctypepackid {
	float: left;
	margin: 0 15px;
	position: relative;
	font-style: italic;
	font-size: 14px;
}
.cctypepacktime {
	border:1px solid #C0C0C0;
	padding: 2px 5px;
	float: left;
	top: -2px;
	background: white;
	color: black;
	position: relative;
	font-size: 14px;
}
.ccdetails {
	clear: both;
	margin-top: 5px;
}
.ccoffer {
	float: right;
	font-size: 20px;
	margin-right: 20px;
	margin-top: 15px;
}

.ccprocess {
	position: relative;
	margin-top: 0px;
	max-width : 250px;
	white-space: nowrap;
	margin-right: 20px;
}

.proIcon {
	height : 18px;
	width: 18px;
	margin-top : 2px;
}

.proIcon:hover {
	background-color : orange;
	border: 1px solid;
}


// .cclinkdetails {
	// clear: both;
	// color: black;
// }


.cclinkdetails {
	float: left;
	position: relative;
	margin-left: 10px;
	margin-top: 3px;
	//padding-top : 5px;
}

.cclinkdetails:hover {
	background-color : orange;
	box-shadow: 2px 2px 2px #888888;
}

.ccplus{
	float: left;
	position: relative;
}

.ccmodify {
	float: left;
	position: relative;
	margin-left: 10px;
}

.ccdelete{
	float: left;
	position: relative;
	margin-left: 10px;
}


.coachevent {
	border:1px solid #C0C0C0;
	color: black;
	padding: 10px;
	margin: 10px;
	font-family: Verdana,Arial,Sans-serif;
	text-align: center;
	width: 80%;
	/*css3*/
	-moz-border-radius:10px;
	-webkit-border-radius:10px;
	border-radius:10px;
	-moz-box-shadow:3px 3px 6px 0 #A9A9A9;
	-webkit-box-shadow:3px 3px 6px #A9A9A9;
	box-shadow:3px 3px 6px 0 #A9A9A9;
}
.ccclient {
	background: lightgreen;
	position: relative;
	left: 50px;
	width: 700px;
}
.cccloudcoach {
	background: #FF7300;
	color: white;
	position: relative;
	left: 150px;
	width: 700px;
}
.cccommercial {
	background: orange;
	color: black;
	position: relative;
	left: 150px;
	width: 700px;
}
.ccinterne {
	background: orange;
	color: black;
	position: relative;
	left: 150px;
	width: 700px;
}
.cegauche {
	float: left;
}
.cedroite {
	float: right;
	max-width: 500px;
}
.cedate {
	position: relative;
	text-align: left;
	font-size: 12px;
}
.ceorig {
	position: relative;
	text-align: left;
	font-size: 12px;
}
.cetype {
	position: relative;
	font-style: italic;
	font-size: 12px;
	float: left;
	left: 10px;
}

.ceprocess {
	float: right;
	position: relative;
	margin-left: 10px;
	white-space : nowrap;
}

.cemodify {
	float: left;
	position: relative;
	margin-left: 15px;
}

.cedelete{
	float: left;
	position: relative;
	margin-left: 15px;
}

.eventproIcon {
	height : 12px;
	width: 12px;
	margin-right : 0px;
	//float : right;
 }
 
 .eventproIcon:hover {
	 background-color : #e8e8e8;
	 box-shadow: 2px 2px 2px #888888;

 }


.cedetails {
	text-align: right;
	position: relative;
	max-width: 550px;
	font-size: 11px;
	margin-top: 25px;
}
.celogstatus {
	text-align: right;
	font-style: italic;
	font-size: 10px;
	margin-top: 10px;
}
.cerecby {
	text-align: right;
	font-style: italic;
	font-size: 10px;
}
textarea {
   height: 80px;
   width: 600px;
   max-height: 160px;
   max-width: 1000px;
}
div.newcctype {
	float: left;
	text-align: center;
	margin: 5px 10px;
}
div.newccprestation {
	float: left;
	text-align: center;
	margin: 5px 10px;
}
.ui-button-text {
	width:85px;
}
.ui-button-text.casepackfc {
	width:100px;
	display: flex;
}
.ui-state-active {
	background: #FF7300;
	color: white;
}
input[type='text'] {
	width: 600px;
	height: 20px;
	font-size: 1.2em;
}
input[type='text'].coachdate {
	width: 80px;
	height: 20px;
	font-size: 1.2em;
}
#formEvent > table tr td +td {
	text-align: left;
}
.coachformbutton.ui-button {
	margin: 20px;
	background: black;
	color: white;
}
.coachformbutton.ui-state-hover {
	margin: 20px;
	background: white;
	color: black;
}
.cecache {
	display:none;
}
#origname {
	vertical-align: middle;
	text-align: center;
	float : left;
}
.ui-autocomplete {
	font-size: 12px;
}
#buttonCaseType .ui-button-text {
	width: 75px;
}
#buttonPackFC .ui-button-text {
	width: 110px;
}
#buttonPackFS .ui-button-text {
	width: 110px;
}
#buttonPackFCA .ui-button-text {
	width: 110px;
}
#infoAccount {
      width: 800px;
      height: 500px;
	font-size: 12px;
	display: none;
	position: relative;
	left: 50px;
	border: 1px solid #C0C0C0;
	background: white;
	color: black;
 	background: lightgrey;
	font-family: Verdana,Arial,Sans-serif;
	text-align: center;
	/*css3*/
	-moz-border-radius:10px;
	-webkit-border-radius:10px;
	border-radius:10px;
	-moz-box-shadow:3px 3px 6px 0 #A9A9A9;
	-webkit-box-shadow:3px 3px 6px #A9A9A9;
	box-shadow:3px 3px 6px 0 #A9A9A9;
      -webkit-perspective: 800px;
         -moz-perspective: 800px;
           -o-perspective: 800px;
              perspective: 800px;
}
.infoAccountfront tr, .infoAccountback tr {
}
.infoAccountfront td {
	font-size: 12px;
	padding: 5px;
	border: 3px solid lightgrey;
	text-align: left;
}
.infoAccountfront td+td {
	background: white;
	padding: 1px 5px;
	width: 570px;
	text-align: left;
}
.infoAccountback td {
	font-size: 12px;
	text-align: left;
}
.infoAccountback tbody {
	border-spacing: 20px;
}
#infoAccountContainer {
     position: relative;
      width: 800px;
      height: 500px;
	margin: 20px 10px 0px 10px;
transform-origin: 100% 240px;
      -webkit-transition: -webkit-transform 1s;
         -moz-transition: -moz-transform 1s;
           -o-transition: -o-transform 1s;
              transition: transform 1s;
      -webkit-transform-style: preserve-3d;
         -moz-transform-style: preserve-3d;
           -o-transform-style: preserve-3d;
              transform-style: preserve-3d;
}
.infoAccount {
	display: block;
      position: absolute;
	  overflow: auto;
	top: 0;
	left: 0;
      width: 800px;
      height: 480px;
      -webkit-backface-visibility: hidden;
         -moz-backface-visibility: hidden;
           -o-backface-visibility: hidden;
              backface-visibility: hidden;
}
.flipped {
      -webkit-transform: rotateX( 180deg );
         -moz-transform: rotateX( 180deg );
           -o-transform: rotateX( 180deg );
              transform: rotateX( 180deg );
}
.infoAccountfront {
	/* for firefox 31 */
	transform: rotateY(0deg);
}
.infoAccountback {
	  font-size: 11px;
      -webkit-transform: rotateX( 180deg );
         -moz-transform: rotateX( 180deg );
           -o-transform: rotateX( 180deg );
              transform: rotateX( 180deg );
}
#buttonModifInfoAccount, #buttonValidInfoAccount, #buttonCancelInfoAccount {
	margin-top: 15px;
}
#buttonValidInfoAccount {
	float: left;
	margin-right: 50px;
	margin-left: 250px;
}
#buttonCancelInfoAccount {
	float: left;
}
.infoAccountback input[type='text'] {
	height: 25px;
}

 /*	image shown when uploading files */
#f1_upload_process{
	z-index:100;
	position:absolute;
	visibility:hidden;
	text-align:center;
	width:400px;
	height : 60px;
	margin:0px;
	padding:0px;
	background-color:#fff;
	border:1px solid #ccc;
}


#upFileForm {
	float : left;
}

/*set icon of list of files uploaded within the form(new or modify case)*/
#PJlist ul {
	list-style-type : url('/images/clips2.png');
	padding: 0px;
	margin: 0px;
}

#PJlist li {
	background: url('/images/clips2.png');
	background-size: 18px 18px;
	background-repeat: no-repeat;
    background-position: 0px center;
    padding-left: 20px; 
	display: block;
	float : left;
	margin-left : 20px;
}

/*the delete icon used to delete uploaded files*/
.deleteFileIcon {
	margin-left : 15px;
	height : 8px;
	weight : 8px;
}

.deleteFileIcon:hover {
	background-color :lightgrey;
}


#listPJ {
	clear : both;
	float : left;
	margin-top : 10px; 
}


/*set the icon of list of uploaded files in the case envelop*/
#listPJ ul {
	list-style-type : url('/images/clips2.png');
	padding: 0px;
	margin: 0px;
}
#listPJ li{
	background: url('/images/clips2.png');
	background-size: 18px 18px;
	background-repeat: no-repeat;
    background-position: 0px center;
    padding-left: 20px; 
	display: block;
	float : left;
	margin-right : 20px;
}

/*define the color of clickable text, e.g. the uploaded file name*/
a:link {
	color : orange;
}

</style>

<script>
	var coachvhmaccount = "";
	var coachaccount = "";
	var coachoffer = "";
	var coachname = "";
	var coachstatus = "";
	var coachorder = "";
	var coachdate = "";
	var coachrecherche = "";
	var caseofferchange = 0;
	var packid ="";
	
	// used to store all the offers existed
	var offreArray = [];
	// var packAmount = { "demarrage":"220", "optimisation":"160", "expert1h":"120", "expert2h":"220", "expert4h":"400", "expertannee":"1500", "prestadevis":"", "logbronze":"300", "logsilver":"550", "loggold":"1000", "logplatinum":"1500", "formation1h":"160", "formation2h":"290", "formation4h":"590", "formationVCD":"600" };
	// var packTime = { "expert1h":"60", "expert2h":"120", "expert4h":"240", "expertannee":"600", "formation1h":"60", "formation2h":"120", "formation4h":"240", "formationVCD":"240" };
	var packTime = [];
	var packAmount = [];
		
</script>

<?php
	echo "<script>" ;
	$i=0;
	
	// get all the offers' names
	foreach($offreArray as $offreItem) {	
		echo "offreArray[".$i."]="."\"".$offreItem->offre."\";" ;	
		$i++;
	}
	
	// get the remaining time and money of all the prestations
	foreach ($allPrestations as $preItem){
		echo "packTime[\"".$preItem->nomc."\"] = \"".$preItem->temps."\";
		packAmount[\"".$preItem->nomc."\"] = \"".$preItem->montant."\";";
	} 
	echo"</script>";	
?>

<div id="coach">
	<div id="headcoach">
		<div id="refreshIcon" title="Mise à jour" style="float:left;padding:0px" onclick="ajaxCoach()"><img src="/images/refresh.png"></div>
		
		<div id="titlecoach">
			<h2>Interventions Cloud Coach</h2>
			<div><span id="nbcases"></span> affaire<span id="plurielnbcases"></span> / <span id="nbevents"></span> évènement<span id="plurielnbevents"></span></div>
		</div>
		<div id="showinfocoachaccount">
			<div><img src="/images/infoaccount.png"></div>
		</div>
		<div id="newcasecoach">
			<div><img src="/images/caseplus.png" title="Créer un nouveau dossier"></div>
		</div>
		<div style="clear:both"></div>
	</div>
	<div id="infoAccount">
		<div id="infoAccountContainer">
			<div id="infoAccountRO" class="infoAccount infoAccountfront">
			</div>
			<div id="infoAccountRW" class="infoAccount infoAccountback">
			</div>
		</div>
	</div>

	<div id="newCase">
		<form id="formCase" action="javascript:ajaxNewCase()" method="POST" enctype="multipart/form-data">
			<table style="font-size: 12px">
				<tr><td><input type="hidden" name="caseidNewCase" value=""></td></tr>
				<tr id="newcaseoffer">
					<td>Offre</td>
					<td>
						<div id="buttonOffer">
							<?php
								$i=1;
								foreach($offreArray as $offreItem) {
									echo "<input type=\"radio\" id=\"caseoffer" . $i . "\" name=\"caseoffer\" value=" . $offreItem->offre . "><label for=\"caseoffer" . $i . "\">" . $offreItem->offre . "</label>";
									$i++ ;
								}
							?>
						</div>
					</td>
				</tr>
				<tr id="newcaseaccount"><td>Raison sociale</td><td><input type="text" name="accountname" value=""></td></tr>
				<tr><td>Résumé (optionnel)</td><td style="text-align: left"><input type="text" name="details" value="" width="800" maxlength="255"></td></tr>
				<tr>
					<td style="vertical-align:middle">Type</td>
					<td>
						<div id="buttonCaseType">
							<div class="newcctype">
							<input type="radio" id="casetype1" name="casetype" value="avantvente"><label for="casetype1">Avant-Vente</label><br/> 
							<input type="radio" id="casetype2" name="casetype" value="devis" style="width:150px"><label for="casetype2">Devis</label> 
							</div>
							<div class="newcctype">
							<input type="radio" id="casetype3" name="casetype" value="tryer"><label for="casetype3">Tryer</label> 
							</div>
							<div class="newcctype">
							<input type="radio" id="casetype4" name="casetype" value="welcome"><label for="casetype4">Welcome</label><br/>
							<input type="radio" id="casetype5" name="casetype" value="30min"><label for="casetype5">30' gratuites</label>
							</div>
							<div class="newcctype">
							<input type="radio" id="casetype6" name="casetype" value="question"><label for="casetype6">Question</label><br/>
							<input type="radio" id="casetype7" name="casetype" value="prestation"><label for="casetype7">Prestation</label> 
							</div>
							<div class="newcctype">
							<input type="radio" id="casetype8" name="casetype" value="conso"><label for="casetype8">Conso nulle</label><br/>
							<input type="radio" id="casetype9" name="casetype" value="alerte"><label for="casetype9">Alerte</label> 
							</div>
							<div class="newcctype">
							<input type="radio" id="casetype10" name="casetype" value="autre"><label for="casetype10">Autre</label> 
							</div>
							<div style="clear: both"></div>
						</div>
					</td>
				</tr>
				
				<?php
				foreach($offreArray as $offreItem) {
				
				$offreName = $offreItem->offre;				
				
				echo "<tr id=\"casePack".$offreName."\">
					<td style=\"vertical-align:middle\">Prestation</td>
					<td>
						<div id=\"buttonPack".$offreName."\">";
							
								$i=1;
								
								foreach($offreItem->prestationPacks as $prePackItem) {
									echo "<div class=\"newccprestation\">";
									foreach($prePackItem as $preItem) {
									echo "<input type=\"radio\" id=\"casepack".$offreName.$i."\" name=\"casepack".$offreName."\" value=".$preItem->nomc."><label for=\"casepack".$offreName.$i."\">".$preItem->noml."</label><br/>";
									$i++ ;
									}
									echo "</div>";
								}
				echo		"<div style=\"clear: both\"></div>
						</div>
					</td>
				</tr>";
				}
				/*
				<tr id="casePackFCA">
					<td style="vertical-align:middle">Prestation</td>
					<td>
						<div id="buttonPackFCA">
							<?php
								$i=1;
								foreach($FCAPrestationArray as $packItem) {
									echo "<div class=\"newccprestation\">";
									foreach($packItem as $preItem) {
									echo "<input type=\"radio\" id=\"casepackfca" . $i . "\" name=\"casepackfca\" value=" . $preItem->nomc . "><label for=\"casepackfca" . $i . "\">" . $preItem->noml . "</label><br/>";
									$i++ ;
									}
									echo "</div>";
								}
							?>	
							<div style="clear: both"></div>	
						</div>
					</td>
				</tr> */
				?>
				<tr id="amountdiv">
					<td></td>
					<td>
					<div style="text-align: left">
							Montant <input name="amountinput" type=text value="" style="width:50px">
					</div>
					</td>
				</tr>
				<tr id="cccoachincharge">
					<td>Coach en charge</td>
					<td>
						<div id="buttonCCCoachEnCharge">
							<?php		
							$i=1;
							foreach($cloudcoachArray as $ccItem) {
								if($ccItem->actif == "O"){ 
								echo "<input type=\"radio\" id=\"ccnomcoach" . $i . "\" name=\"ccnomcoach\" value=" . $ccItem->prenom . "><label for=\"ccnomcoach" . $i . "\">" . $ccItem->prenom . "</label>";					
								$i++ ;
								}
							}
							?>
						</div>
					</td>
				</tr>
				<tr id="pjuploaded">	
				<td>PJ Téléchargé</td>
				<td>
					<div id="PJlist">
					
					</div>
				</td>
				</tr>	
				
			</table>
		</form>
		
		
		<form action="upload.php" id="upFileForm" method="post" enctype="multipart/form-data" target="upload_target" onsubmit="startUpload();">
			<img src="/images/clip.jpg" id="upfileIcone" style="cursor:pointer" title="Ajouter des fichiers" alt="Ajouter des fichiers" height="40" width="40"/>
			<span id="selectedFile"></span>
			<input type="file" name="fileToUpload" id="fileToUpload" style="display:none" />
			<input type="hidden" name="dirofPJ" value="dirofPJ">
			<input type="submit" id="addButton" value="Joindre" name="submit"/>
		</form>
		
		<p id="f1_upload_process"> Uploading...<br/><img src='/images/loader.gif' /> </p>
		
		<iframe id="upload_target" name="upload_target" src="#" style="width:0;height:0;border:0px solid #fff;">
		</iframe>
		
		<button id="buttonCCReset" class="coachformbutton" onclick="resetNewCasebyButton()">Reset</button>
		<button id="buttonCCSubmit" class="coachformbutton" onclick="submitFormCase()">Valider</button>
	</div>


	<div id="newEvent">
		<form id="formEvent" action="javascript:ajaxNewEvent()" method="POST">
			<input type="hidden" name="caseid" value="">
			<table style="font-size: 12px">
				<tr id="eventdate"><td>Date</td><td><input type="text" name="eventdate" class="coachdate"></td></tr>
				<tr>
					<td>Initiateur</td>
					<td>
						<div id="buttonOrigRole" style="float:left; vertical-align:middle">
							<input type="radio" id="origrole1" name="origrole" value="client"><label for="origrole1">Client</label> 
							<input type="radio" id="origrole2" name="origrole" value="cloudcoach"><label for="origrole2">Cloud Coach</label> 
							<input type="radio" id="origrole3" name="origrole" value="commercial"><label for="origrole3">Commercial</label>
							<input type="radio" id="origrole4" name="origrole" value="interne"><label for="origrole4">Interne</label>
						</div>
						<div id="origname"><input type="text" name="origname" value="" style="width:200px"></div>
					</td>
				</tr>
				<tr>
					<td>Medium</td>
					<td>
						<div id="buttonMedium">
							<input type="radio" id="medium1" name="medium" value="courriel"><label for="medium1">Courriel</label> 
							<input type="radio" id="medium2" name="medium" value="tel"><label for="medium2">Téléphone</label> 
							<input type="radio" id="medium3" name="medium" value="portail"><label for="medium3">ECE / MSCT</label>
							<input type="radio" id="medium4" name="medium" value="ofc"><label for="medium4">Communauté</label>
							<input type="radio" id="medium5" name="medium" value="im"><label for="medium5">IM</label>
							<input type="radio" id="medium6" name="medium" value="autre"><label for="medium6">Autre</label>
						</div>
					</td>
				</tr>
				<tr id="cemsctid">
					<td>MSCT id</td>
					<td>
						<input name="msctid" type=text value="" style="width:130px"><br/>
					</td>
				</tr>
				<tr>
					<td>Type</td>
					<td>
						<div id="buttonEventType">
							<input type="radio" id="eventtype1" name="eventtype" value="echange" disabled><label for="eventtype1">Client &lt;=&gt; Coach</label> 
							<input type="radio" id="eventtype2" name="eventtype" value="absent" disabled><label for="eventtype2">Appel infructueux</label> 
						</div>
					</td>
				</tr>
				<tr><td style="vertical-align:middle">Détails</td><td><textarea name="cedetails" style="width:500"></textarea></td></tr>
				<tr id="cecoachincharge">
					<td>Coach en charge</td>
					<td>
						<div id="buttonCECoachEnCharge">
							<?php		
							$i=1;
							foreach($cloudcoachArray as $ccItem) {
								echo "<input type=\"radio\" id=\"cenomcoach" . $i . "\" name=\"cenomcoach\" value=" . $ccItem->prenom . "><label for=\"cenomcoach" . $i . "\">" . $ccItem->prenom . "</label>";					
								$i++ ;
							}
							?>
						
						</div>
					</td>
				</tr>
				<tr id="buttonNewCaseStatusTR">
					<td>Nouvel état dossier</td>
					<td>
						<div id="buttonNewCaseStatus">
							<input type="radio" id="newcasestatus1" name="newcasestatus" value="NOUVEAU" disabled><label for="newcasestatus1">NOUVEAU</label> 
							<input type="radio" id="newcasestatus2" name="newcasestatus" value="EN COURS"><label for="newcasestatus2">EN COURS</label> 
							<input type="radio" id="newcasestatus3" name="newcasestatus" value="EN ATTENTE"><label for="newcasestatus3">EN ATTENTE</label> 
							<input type="radio" id="newcasestatus4" name="newcasestatus" value="SUSPENDU"><label for="newcasestatus4">SUSPENDU</label>
							<input type="radio" id="newcasestatus5" name="newcasestatus" value="REJETE"><label for="newcasestatus5">REJETE</label>
							<input type="radio" id="newcasestatus6" name="newcasestatus" value="CLOS"><label for="newcasestatus6">CLOS</label>
						</div>
					</td>
				</tr>
				<tr id="datesuspended"><td>Date suspension</td><td><input type="text" name="datesuspended" class="coachdate"></td></tr>
				<tr id="eventtimepassed"><td>Temps passé (min.)</td><td><input type="text" name="passedtime" value="" style="width:50px"></td></tr>
				<tr id="casedetailsTR"><td>Résumé (optionnel)</td><td style="text-align: left"><input type="text" name="casedetails" value="" width="800" maxlength="255"></td></tr>
			</table>
			<input type="hidden" value="newevent" name="action">
		</form>
		<button id="buttonCEReset" class="coachformbutton" onclick="resetNewEvent()">Reset</button>
		<button id="buttonCESubmit" class="coachformbutton" onclick="submitFormEvent()">Valider</button>
	</div>

			
	<div id="resCase">
	</div>
</div>

<script>
//	var packAmount = { "demarrage":"330", "construction":"330", "optimisation":"440", "performance":"440", "securite":"440", "expert1h":"160", "expert2h":"270", "expert4h":"490", "expertannee":"1500", "prestadevis":"", "logbronze":"330", "logsilver":"880", "loggold":"1300", "logplatinum":"2600", "formation1h":"160", "formation2h":"290", "formation4h":"590" };
	
	//var packAmount = { "demarrage":"220", "optimisation":"160", "expert1h":"120", "expert2h":"220", "expert4h":"400", "expertannee":"1500", "prestadevis":"", "logbronze":"300", "logsilver":"550", "loggold":"1000", "logplatinum":"1500", "formation1h":"160", "formation2h":"290", "formation4h":"590", "formationVCD":"600" };
	//var packTime = { "expert1h":"60", "expert2h":"120", "expert4h":"240", "expertannee":"600", "formation1h":"60", "formation2h":"120", "formation4h":"240", "formationVCD":"240" };
	
	
	
	//function called when  uploading files, show the image "uploading"
	function startUpload() {
		document.getElementById('f1_upload_process').style.visibility = 'visible';
		return true;
	}
	
	//function called when ending uploading files, hide the image "uploading"
	//when failed, alert the error 
	function stopUpload(result) {
		//alert(result);
		if(result == 1) 	ajaxUpdatePJList();
		else if(result == 2)	alert("Fichier téléchargé est trop grand (taille max: 2Mo)");
		else if(result == 3)	alert("Un nom du fichier ne doit contenir que les caractères suivants: a-z A-Z 0-9  _  -  .  espace");
		else {
			alert(" Téléchargement échoué, result = "+result);
		}
		document.getElementById('f1_upload_process').style.visibility = 'hidden';	
		return true; 
	}
	
	
	/**********************   upload functions called when change the value of radio buttons *************/
	function updateAccountname() {
		var c;
		if ($("input:text[name='accountname']").val() != "") {
			$("input:radio[name='casetype']").prop("disabled",false);
		} else {
			$("input:radio[name='casetype']").prop("disabled",true);
			c = $("input:radio[name='casetype']:checked").val();
			if (c != 'avantvente' && c != 'avantvente' && c != 'avantvente') { $("input:radio[name='casetype']").prop("checked",false); }
			$("input:radio[name='casetype'][value='avantvente']").prop("disabled",false);
			$("input:radio[name='casetype'][value='devis']").prop("disabled",false);
			$("input:radio[name='casetype'][value='autre']").prop("disabled",false);
		}
		$("input:radio[name='casetype']").button("refresh");
	}
	
	function updateCoachOffer() {
		resetNewCase();
	}
	
	function updatePackCC() {

		//show casePack selected
		for(var i=0; i<offreArray.length; i++) {
			var offrename = offreArray[i];
			if(coachoffer == offrename || $("input:radio[name='caseoffer']:checked").val() == offrename) {
				packid = "input:radio[name='casepack"+offrename+"']:checked";
				packname = $(packid).val();
				//alert(packname);
				break;
			}
		}
			/* 
			if (coachoffer == "FS" || $("input:radio[name='caseoffer']:checked").val() == "FS") {
				packname = $("input:radio[name='casepackfs']:checked").val();
			} 
			else if (coachoffer == "FCE" || $("input:radio[name='caseoffer']:checked").val() == "FCE") {
				packname = $("input:radio[name='casepackfc']:checked").val();				
			}
			else if (coachoffer == "FCA" || $("input:radio[name='caseoffer']:checked").val() == "FCA") {
					packname = $("input:radio[name='casepackfc']:checked").val();				
			} */
			if(packAmount[packname] == 'NULL') {
				$("input[name='amountinput']").val("");
				$("input[name='amountinput']").prop('disabled',false);
			}
			else {
				$("input[name='amountinput']").val(packAmount[packname]);
				$("input[name='amountinput']").prop('disabled',true);
			}
		
	}

	function updateCaseType() {
		
		$("input:text[name='amountinput']").val("");

		if ($("input:radio[name='casetype']:checked").val() == "prestation") {
		
		for(var i=0; i<offreArray.length; i++) {
			if(coachoffer == offreArray[i] || $("input:radio[name='caseoffer']:checked").val() == offreArray[i]) {
				packid = "#casePack"+offreArray[i];
				$(packid).css("display","table-row");
				break;
			}
		}
			//$("input:radio[name='casepack']").prop("checked",false);
			$("#amountdiv").css("display","table-row");
			
			//$("input:radio[name='casepack']").button("refresh");
		} 
		
		else if($("input:radio[name='casetype']:checked").val() == "devis"){
			
			//hide all casePacks
			for(var i=0; i<offreArray.length; i++) {
				packid = "#casePack"+offreArray[i];
				$(packid).css("display","none");
			}
			/* 
			$("#casePackFC").css("display","none");
			$("#casePackFS").css("display","none");
			$("#casePackFCA").css("display","none"); */
			
			
			$("#amountdiv").css("display","table-row");
			$("input[name='amountinput']").prop('disabled',false);
		}
		else {
			//hide all casePacks
			for(var i=0; i<offreArray.length; i++) {
				packid = "#casePack"+offreArray[i];
				$(packid).css("display","none");
			}
			
			$("#amountdiv").css("display","none");
		}
		
	}
	
	function updateOrigRole() {
		var idcase = $("#newEvent").parent().get(0).id;
		var casetype;

		if ($("input:radio[name='origrole']:checked").val() == "cloudcoach") {
			$("#origname").css("display","none");
			$("input:text[name='origname']").val("");

			if ($("#"+idcase+">div.cccentre>div.cctype>div.cctypepacknom").length) {
				casetype = $("#"+idcase+">div.cccentre>div.cctype>div.cctypepacknom").attr("packname");
				
				if (packTime[casetype] != "NULL") {  $("#eventtimepassed").css("display","table-row"); }
				else { $("input:text[name='passedtime']").val(""); $("#eventtimepassed").css("display","none"); }
			} else {
				$("input:text[name='passedtime']").val(""); $("#eventtimepassed").css("display","none");
			}
//			$("#eventtimepassed").css("display","table-row");
		} else {
			$("#origname").css("display","table-row");
			$("#eventtimepassed").css("display","none");
			$("input:text[name='timepassed']").val("");
			if ($("input:radio[name='origrole']:checked").val() == "client") {
				$("input:text[name='origname']").autocomplete({source:dataOrig.listeclient});
				$("input:text[name='origname']").val(dataOrig.defaultclient);
			} else {
				if ($("input:radio[name='origrole']:checked").val() == "commercial") {
					$("input:text[name='origname']").autocomplete({source:dataOrig.listecommercial});
					$("input:text[name='origname']").val(dataOrig.defaultcommercial);
				} else {
					if ($("input:radio[name='origrole']:checked").val() == "interne") {
						$("input:text[name='origname']").autocomplete({source:dataOrig.listeinterne});
						$("input:text[name='origname']").val(dataOrig.defaultinterne);
					}
				}
			}
		}
		updateEventType();
	}
	
	function updateEventType() {
		$("input:radio[name='eventtype']").prop("disabled",false);
		if ($("input:radio[name='origrole']:checked").val() == "client") {
			$("input:radio[name='eventtype'][value='absent']").prop("disabled",true);
			$("input:radio[name='eventtype'][value='absent']").prop("checked",false);
		} else {
			if ($("input:radio[name='origrole']:checked").val() == "cloudcoach") {
				if ($("input:radio[name='medium']:checked").val() != "tel") {
					$("input:radio[name='eventtype'][value='absent']").prop("disabled",true);
					$("input:radio[name='eventtype'][value='absent']").prop("checked",false);
				} else {
//alert($("input:radio[name='eventtype']:checked").val());
					if ($("input:radio[name='eventtype']:checked").val() == "absent" && $("textarea[name='cedetails']").val() == "") {
						$("textarea[name='cedetails']").val("Appel infructueux");
					}
				}
			} else {
				$("input:radio[name='eventtype']").prop("disabled",true);
				$("input:radio[name='eventtype']").prop("checked",false);
			}
		}
		//$("input:radio[name='eventtype']").button("refresh");
	}
	
	function updateMedium() {
		updateEventType();
	}

	
	
	
	if (coachoffer == "" || coachoffer == "TOUTES") {
		$("#buttonOffer").buttonset();
		$("#buttonOffer").change( function() { 
												console.log("buttonofferchange"); 
												caseofferchange = 1 ;
												resetNewCase();
												
											 } );
	} else {
		$("#newcaseoffer").css("display","none");
	}

	
//	if (coachaccount != "") {
//		$("#newcaseaccount").css("display","none");
//	}
//	$("#buttonModifInfoAccount").button();
//	$("#buttonModifInfoAccount").click( function () { alert('toggle'); $(".infoAccount").toggleClass('flipped'); } );
//	$("#infoAccount").click( function () { $("#infoAccountContainer").toggleClass('flipped'); } );
	$("#buttonCaseType").buttonset();
//	$("#buttonCaseType").change( function() { updatePackCC(); } )
	
	
	//icon clicked for unloading files
	$("#upfileIcone").click(function () {
		$("#fileToUpload").trigger('click');
	});
	
	//name of selected file to upload
	$('#fileToUpload').change(function () {
		$('#selectedFile').html($('#fileToUpload').val());
		if($('#fileToUpload').val() != "")	$('#addButton').css("display","inline");
	});
	
	
	//*******  set buttons and datepicker  ***********************/
 	$("#buttonOrigRole").buttonset();
	$("#buttonOrigRole").change( function() { updateOrigRole(); } )
	$("#buttonCCCoachEnCharge").buttonset();
	$("#buttonCECoachEnCharge").buttonset();
	$("#buttonMedium").buttonset();
	$("#buttonMedium").change( function() { if ($("input:radio[name='medium']:checked").val() == "portail") { $("#cemsctid").css("display","table-row"); } else { $("#cemsctid").css("display","none"); } } )
//	$("#buttonEventType").buttonset();
	$("#buttonNewCaseStatus").buttonset();
	$("#buttonNewCaseStatus").change( function() { if ($("input:radio[name='newcasestatus']:checked").val() == "SUSPENDU") { $("#datesuspended").css("display","table-row"); } else { $("#datesuspended").css("display","none"); } } )
	
	$.datepicker.setDefaults( $.datepicker.regional[ "fr" ] );
	$( ".coachdate" ).datepicker({ dateFormat: "yy-mm-dd" });
//	$("input:text[name='datesuspended']").datepicker();
	$( "input:text[name='datesuspended']" ).datepicker("option", "minDate", "+1d");
	$( "input:text[name='datesuspended']" ).datepicker("option", "maxDate", "+1m");
//	$( "input:text[name='eventdate']" ).datepicker();
	$( "input:text[name='eventdate']" ).datepicker("option", "maxDate", "+0d");
//	$( "input:text[name='eventdate']" ).datepicker({ maxDate: new Date("+0d") });
	$("#buttonCCReset").button();
	$("#buttonCCSubmit").button();
	$('#buttonCCSubmit').prop('disabled',false);
	$("#buttonCEReset").button();
	$("#buttonCESubmit").button();
	

	
	/*used to pretend multiple submissions of forms */
	function submitFormCase() {
		$('#formCase').submit();
		$('#buttonCCSubmit').prop("disabled",true);
		
		//enable the submit button after 1 second
		setTimeout(function(){
			$('#buttonCCSubmit').prop("disabled",false);
			$('#buttonCCSubmit').removeClass("ui-state-hover");
		},1000);
	}	
	
	function submitFormEvent() {
		$('#formEvent').submit();
		$('#buttonCESubmit').prop("disabled",true);
		
		//enable the submit button after 1 second
		setTimeout(function(){
			$('#buttonCESubmit').prop("disabled",false);
			$('#buttonCESubmit').removeClass("ui-state-hover");
		},1000);
	}

	
	
	/*set the function to be called for all the radio buttons*/
	$("input:text[name='accountname']").change( function() {
												updateAccountname();
								} );

	$("input:radio[name='casetype']").change( function() {
												updateCaseType();
								} );

	$("input:radio[name='eventtype']").change( function() {
												updateEventType();
								} );

	$("input:radio[name='medium']").change( function() {
												updateMedium();
								} );
	
	//casepacks
	for(var i=0; i<offreArray.length; i++) {
		packid ="input:radio[name='casepack"+offreArray[i] + "']";
		$(packid).change( function() { updatePackCC(); } )
	}
	
	for(var i=0; i<offreArray.length; i++) {
		packid = "#buttonPack" +offreArray[i];
		$(packid).buttonset();
		$(packid).change( function() { updatePackCC(); } )
	}
								
								
	$("input:text[name='msctid']").change( function() {
												if ($("textarea[name='cedetails']").val() == "") { $("textarea[name='cedetails']").val("Dépôt de la demande "+$("input:text[name='msctid']").val()); }
								} );

	$("#newcasecoach").click( function() {
							showNewCase();
							} );
//	$("#showinfocoachaccount").click( function() {
//								$("#infoAccount").toggle("blind",{"direction":"up"});
//								} );


</script>
